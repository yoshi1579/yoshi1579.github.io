<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ul.lst-kix_pzopjtbr53ce-1{list-style-type:none}ul.lst-kix_pzopjtbr53ce-0{list-style-type:none}ul.lst-kix_pzopjtbr53ce-3{list-style-type:none}ul.lst-kix_pzopjtbr53ce-2{list-style-type:none}.lst-kix_pzopjtbr53ce-0>li:before{content:"\0025cf  "}ul.lst-kix_pzopjtbr53ce-5{list-style-type:none}.lst-kix_pzopjtbr53ce-8>li:before{content:"\0025a0  "}ul.lst-kix_pzopjtbr53ce-4{list-style-type:none}ul.lst-kix_pzopjtbr53ce-7{list-style-type:none}ul.lst-kix_pzopjtbr53ce-6{list-style-type:none}ul.lst-kix_pzopjtbr53ce-8{list-style-type:none}.lst-kix_pzopjtbr53ce-7>li:before{content:"\0025cb  "}.lst-kix_pzopjtbr53ce-4>li:before{content:"\0025cb  "}.lst-kix_pzopjtbr53ce-2>li:before{content:"\0025a0  "}.lst-kix_pzopjtbr53ce-6>li:before{content:"\0025cf  "}.lst-kix_pzopjtbr53ce-1>li:before{content:"\0025cb  "}.lst-kix_pzopjtbr53ce-5>li:before{content:"\0025a0  "}.lst-kix_pzopjtbr53ce-3>li:before{content:"\0025cf  "}ol{margin:0;padding:0}table td,table th{padding:0}.c6{color:#ce9178;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:9pt;font-family:"Courier New";font-style:normal}.c11{color:#569cd6;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:9pt;font-family:"Courier New";font-style:normal}.c1{color:#d4d4d4;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:9pt;font-family:"Courier New";font-style:normal}.c2{color:#333333;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Arial";font-style:normal}.c5{color:#24292e;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Verdana";font-style:normal}.c0{padding-top:0pt;text-indent:36pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c3{padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c21{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c14{text-decoration-skip-ink:none;font-size:10pt;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c34{background-color:#ffffff;color:#ff0000;font-weight:400;font-size:10.5pt;font-family:"Arial"}.c18{background-color:#ffffff;color:#222222;font-weight:700;font-size:10.5pt;font-family:"Arial"}.c40{font-size:9pt;font-family:"Courier New";color:#b5cea8;font-weight:400}.c32{font-size:9pt;font-family:"Courier New";color:#9cdcfe;font-weight:700}.c8{font-size:9pt;font-family:"Courier New";color:#ce9178;font-weight:400}.c33{font-size:9pt;font-family:"Courier New";color:#c586c0;font-weight:700}.c28{font-size:9pt;font-family:"Courier New";color:#569cd6;font-weight:700}.c9{font-size:9pt;font-family:"Courier New";color:#ce9178;font-weight:700}.c17{color:#333333;font-weight:700;font-size:12pt;font-family:"Arial"}.c42{color:#608b4e;font-weight:700;font-size:9pt;font-family:"Courier New"}.c23{color:#333333;font-weight:400;font-size:12pt;font-family:"Arial"}.c7{font-size:9pt;font-family:"Courier New";color:#d4d4d4;font-weight:700}.c16{color:#000000;font-weight:400;font-size:11pt;font-family:"Arial"}.c27{color:#24292e;font-weight:700;font-size:12pt;font-family:"Verdana"}.c24{font-size:9pt;font-family:"Courier New";color:#c586c0;font-weight:400}.c15{color:#608b4e;font-weight:400;font-size:9pt;font-family:"Courier New"}.c31{color:#000000;font-weight:400;font-size:9pt;font-family:"Courier New"}.c22{color:#569cd6;font-weight:400;font-size:9pt;font-family:"Courier New"}.c38{background-color:#ffffff;font-size:8pt;color:#cccccc;font-weight:700}.c4{font-size:9pt;font-family:"Courier New";color:#d4d4d4;font-weight:400}.c19{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c25{font-size:9pt;font-family:"Courier New";color:#9cdcfe;font-weight:400}.c30{color:#b5cea8;font-weight:700;font-size:9pt;font-family:"Courier New"}.c36{background-color:#f0f0f0;color:#000000;font-size:12pt}.c39{font-size:18pt;color:#333333;font-weight:700}.c44{color:#dcdcaa;font-size:9pt;font-family:"Courier New"}.c29{background-color:#ffffff;font-size:10.5pt;color:#222222}.c12{text-decoration:none;vertical-align:baseline;font-style:normal}.c46{color:#d9d9d9;font-size:9pt;font-family:"Courier New"}.c45{background-color:#ffffff;max-width:451.4pt;padding:72pt 72pt 72pt 72pt}.c48{color:#cccccc;font-size:8pt;font-family:"Courier New"}.c13{color:inherit;text-decoration:inherit}.c37{font-weight:700;font-family:"Arial"}.c41{font-size:10pt;color:#24292e}.c20{color:#333333;font-size:10pt}.c26{font-weight:400;font-family:"Verdana"}.c49{color:#0000ff;font-size:10pt}.c35{font-weight:400;font-family:"Arial"}.c10{height:11pt}.c47{font-family:"Verdana"}.c43{font-weight:700}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c45"><p class="c3"><span class="c39">Elasticsearch tutorial for full-text search</span><span class="c17 c12">&nbsp;</span></p><p class="c3"><span class="c17 c12">Author: Yoshinobu Nakada</span></p><p class="c3 c10"><span class="c17 c12"></span></p><p class="c3"><span class="c12 c17">introduction: what is the tool for, what was it used for on your project</span></p><p class="c3 c10"><span class="c2"></span></p><p class="c3"><span class="c2">Tool: Elasticsearch</span></p><p class="c3"><span class="c2">Used for: &nbsp;Full text search for the IDBM phase 3</span></p><p class="c3 c10"><span class="c2"></span></p><p class="c3"><span class="c17 c12">History: who created it, when was it created, where was it created</span></p><p class="c3"><span class="c29">Elasticsearch is developed in Java and a database specifically for searching based on Lucene. It provides schema-free JSON documents, and also it enables distributed multitenant-capable full-text searching. It has an HTTP web interface and it is available in Java, .NET (C#), PHP, Python, Apache Groovy, Ruby and many other languages. &nbsp;</span></p><p class="c3 c10"><span class="c29 c12 c35"></span></p><p class="c3"><span class="c12 c34">From now on, I will describe exactly what I did to set up a fully functional Elasticsearch for full text search for the phase 3. Elasticsearch even handles pagination / highlighting the matching words with &lt;em&gt; html tag / the following normalization, &lsquo;running -&gt; run&rsquo; , &lsquo;Happiest -&gt; happy&rsquo; , &lsquo;employed -&gt; employ&rsquo; etc &nbsp;</span></p><p class="c3 c10"><span class="c34 c12"></span></p><p class="c3"><span class="c12 c37 c20">Before start installing Elasticsearch, I highly recommend to understand why Elasticsearch is better than SQL for full text search by watching the following video. The following video explains the basic of how to use Elasticsearch with python. </span></p><p class="c21"><span class="c19"><a class="c13" href="https://www.google.com/url?q=https://www.youtube.com/watch?v%3DUPkqFvjN-yI&amp;sa=D&amp;ust=1532142477360000">https://www.youtube.com/watch?v=UPkqFvjN-yI</a></span></p><p class="c3 c10"><span class="c2"></span></p><p class="c3"><span class="c20">installation: step by step instructions on how to install it on different environments, especially on </span><span class="c12 c20 c37">Docker</span></p><p class="c3"><span class="c2">Local environment: </span></p><p class="c3"><span class="c20">Mac/Windows/Ubuntu: </span><span class="c14"><a class="c13" href="https://www.google.com/url?q=https://www.elastic.co/downloads/past-releases/elasticsearch-2-4-0&amp;sa=D&amp;ust=1532142477360000">https://www.elastic.co/downloads/past-releases/elasticsearch-2-4-0</a></span></p><p class="c3"><span class="c2">Download the zip or tar file </span></p><p class="c3"><span class="c2">-&gt; extract the file </span></p><p class="c3"><span class="c2">-&gt; cd elasticsearch-2.4.0/bin &nbsp;</span></p><p class="c3"><span class="c2">-&gt; &nbsp;./elasticsearch </span></p><p class="c3"><span class="c2">Now, Elasticsearch 2.4 is running in your local environment</span></p><p class="c3 c10"><span class="c2"></span></p><p class="c3"><span class="c20 c43">Insert data into Elasticsearch database</span><span class="c2">:</span></p><p class="c3"><span class="c2">tool: python3 </span></p><p class="c3"><span class="c20">Need to install: </span><span class="c12 c35 c36">pip install elasticsearch2</span></p><p class="c3 c10"><span class="c2"></span></p><p class="c3 c10"><span class="c2"></span></p><p class="c3 c10"><span class="c2"></span></p><p class="c3"><span class="c12 c23">use: step by step by instructions on how to use it</span></p><p class="c3"><span class="c2">create database &amp; table &amp; insert one entry -&gt; imply run &nbsp;&ldquo;python3 es.py&rdquo; &nbsp; </span></p><p class="c3"><span class="c2">es.py </span></p><p class="c3"><span class="c24">from</span><span class="c4">&nbsp;elasticsearch </span><span class="c24">import</span><span class="c4 c12">&nbsp;Elasticsearch</span></p><p class="c3"><span class="c4">client = Elasticsearch(</span><span class="c8">&#39;localhost:9200&#39;</span><span class="c4 c12">)</span></p><p class="c3 c10"><span class="c4 c12"></span></p><p class="c3"><span class="c15"># make sure that a database named &lsquo;test&rsquo; does not exist</span></p><p class="c3"><span class="c4">client.indices.delete(</span><span class="c25">index</span><span class="c4">=</span><span class="c8">&#39;test&#39;</span><span class="c4">, </span><span class="c25">ignore</span><span class="c4">=[</span><span class="c40">400</span><span class="c4">, </span><span class="c40">404</span><span class="c4 c12">])</span></p><p class="c3 c10"><span class="c4 c12"></span></p><p class="c3"><span class="c15"># in Elasticsearch, database == index, table == doc, shcema == mapping</span></p><p class="c3"><span class="c15 c12"># this will create a database (index)</span></p><p class="c3"><span class="c15 c12"># &#39;analyzer&#39;: &#39;english&#39; is a build-in analyzer</span></p><p class="c3"><span class="c15 c12"># With english analyzer</span></p><p class="c3"><span class="c12 c15"># I&#39;m not happy about the foxes -&gt; i&#39;m, happi, about, fox</span></p><p class="c3"><span class="c15 c12"># &#39;index&#39;: &#39;not_analyzed&#39; will make the column not to be analyzed.</span></p><p class="c3 c10"><span class="c15 c12"></span></p><p class="c3"><span class="c15 c12"># the following code create a database (&#39;test_table&#39;) with columns (id, name, age)</span></p><p class="c3"><span class="c4 c12">mappings = {</span></p><p class="c3"><span class="c4">&nbsp; &nbsp;</span><span class="c8">&#39;mappings&#39;</span><span class="c4 c12">: {</span></p><p class="c3"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8">&#39;pet&#39;</span><span class="c4 c12">: {</span></p><p class="c3"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8">&#39;properties&#39;</span><span class="c4 c12">: {</span></p><p class="c3"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8">&#39;id&#39;</span><span class="c4 c12">: {</span></p><p class="c3"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8">&#39;type&#39;</span><span class="c4">: </span><span class="c8">&#39;string&#39;</span><span class="c4 c12">,</span></p><p class="c3"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8">&#39;index&#39;</span><span class="c4">: </span><span class="c8 c12">&#39;not_analyzed&#39;</span></p><p class="c3"><span class="c4 c12">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},</span></p><p class="c3"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8">&#39;name&#39;</span><span class="c4 c12">: {</span></p><p class="c3"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8">&#39;type&#39;</span><span class="c4">: </span><span class="c8">&#39;string&#39;</span><span class="c4 c12">,</span></p><p class="c3"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8">&#39;analyzer&#39;</span><span class="c4">: </span><span class="c8">&#39;english&#39;</span></p><p class="c3"><span class="c4 c12">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},</span></p><p class="c3"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8">&#39;age&#39;</span><span class="c4 c12">: {</span></p><p class="c3"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8">&#39;type&#39;</span><span class="c4">: </span><span class="c8">&#39;string&#39;</span><span class="c4 c12">,</span></p><p class="c3"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8">&#39;analyzer&#39;</span><span class="c4">: </span><span class="c8">&#39;english&#39;</span></p><p class="c3"><span class="c4 c12">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c3"><span class="c4 c12">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c3"><span class="c4 c12">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c3"><span class="c4 c12">&nbsp; &nbsp;}</span></p><p class="c3"><span class="c4 c12">}</span></p><p class="c3"><span class="c4">client.indices.create(</span><span class="c25">index</span><span class="c4">=</span><span class="c8">&#39;test&#39;</span><span class="c4">, </span><span class="c25">body</span><span class="c4 c12">=mappings)</span></p><p class="c3 c10"><span class="c4 c12"></span></p><p class="c3"><span class="c15"># this will create a table (doc) and insert one entry</span></p><p class="c3"><span class="c4 c12">doc = {</span></p><p class="c3"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8">&#39;id&#39;</span><span class="c4">: </span><span class="c8">&#39;1&#39;</span><span class="c4 c12">,</span></p><p class="c3"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8">&#39;name&#39;</span><span class="c4">: </span><span class="c8">&#39;yoshi&#39;</span><span class="c4 c12">,</span></p><p class="c3"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8">&#39;age&#39;</span><span class="c4">: </span><span class="c8">&#39;18&#39;</span></p><p class="c3"><span class="c4 c12">&nbsp; &nbsp;}</span></p><p class="c3 c10"><span class="c4 c12"></span></p><p class="c3"><span class="c15 c12"># here we have to specify unique id</span></p><p class="c3"><span class="c4">client.create(</span><span class="c25">index</span><span class="c4">=</span><span class="c8">&#39;test&#39;</span><span class="c4">, </span><span class="c25">doc_type</span><span class="c4">=</span><span class="c8">&#39;student&#39;</span><span class="c4">, </span><span class="c25">body</span><span class="c4">=doc, </span><span class="c25">id</span><span class="c4">=</span><span class="c8">&#39;1&#39;</span><span class="c4 c12">)</span></p><p class="c3 c10"><span class="c4 c12"></span></p><p class="c3"><span class="c20">Get the entry just inserted from the tabel &ldquo;student&rdquo; in a database &ldquo;test&rdquo; -&gt; imply run &nbsp;&ldquo;python3 query.py&rdquo; </span></p><p class="c3"><span class="c2">query.py</span></p><p class="c3"><span class="c15"># search keyword &lsquo;yoshi&rsquo; in all fields</span></p><p class="c3"><span class="c4 c12">query = {</span></p><p class="c3"><span class="c4">&nbsp; &nbsp;</span><span class="c8">&quot;query&quot;</span><span class="c4 c12">: {</span></p><p class="c3"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8">&quot;match&quot;</span><span class="c4 c12">: {</span></p><p class="c3"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8">&quot;_all&quot;</span><span class="c4">: </span><span class="c8">&#39;yoshi&#39;</span></p><p class="c3"><span class="c4 c12">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c3"><span class="c4 c12">&nbsp; &nbsp;}</span></p><p class="c3"><span class="c4 c12">}</span></p><p class="c3"><span class="c4">client.search(</span><span class="c25">index</span><span class="c4">=</span><span class="c8">&#39;test</span><span class="c8">&#39;</span><span class="c4">, </span><span class="c25">body</span><span class="c4 c12">=query)</span></p><p class="c3 c10"><span class="c2"></span></p><p class="c3"><span class="c5">See table with UI: use a elasticsearch head plugin, go into the elasticsearch directory you downloaded and run</span></p><p class="c3 c10"><span class="c5"></span></p><p class="c3"><span class="c5">sudo bin/plugin install mobz/elasticsearch-head</span></p><p class="c3 c10"><span class="c5"></span></p><p class="c3"><span class="c27 c12">Set up Elasticsearch in AWS</span></p><p class="c21"><span class="c16 c12">how to set up Elasticsearch in AWS. AWS provides Elasticsearch as a service, so we don&rsquo;t need to install Elasticsearch in a docker. </span></p><p class="c21"><span class="c19"><a class="c13" href="https://www.google.com/url?q=https://www.youtube.com/watch?v%3DKXrupsR9aHo&amp;sa=D&amp;ust=1532142477367000">https://www.youtube.com/watch?v=KXrupsR9aHo</a></span></p><p class="c3 c10"><span class="c5"></span></p><p class="c3"><span class="c27">Pagination:</span><span class="c5">&nbsp;</span></p><p class="c3"><span class="c5">simply add from_ and size arguments to search function call. </span></p><p class="c3"><span class="c5">from_ : number of results to skip</span></p><p class="c3"><span class="c5">size: number of results to show</span></p><p class="c3"><span class="c4">client.search(</span><span class="c25">index</span><span class="c4">=</span><span class="c8">&#39;test&#39;</span><span class="c4">, </span><span class="c25">body</span><span class="c4">=query, </span><span class="c25">from_</span><span class="c4">=0, </span><span class="c25">size</span><span class="c4 c12">=9)</span></p><p class="c3 c10"><span class="c4 c12"></span></p><p class="c21"><span class="c16 c12">** reference</span></p><p class="c21"><span class="c16 c12">elasticsearch pagination explained</span></p><p class="c21"><span class="c19"><a class="c13" href="https://www.google.com/url?q=https://www.elastic.co/guide/en/elasticsearch/guide/current/pagination.html&amp;sa=D&amp;ust=1532142477367000">https://www.elastic.co/guide/en/elasticsearch/guide/current/pagination.html</a></span></p><p class="c21 c10"><span class="c16 c12"></span></p><p class="c21"><span class="c16 c12">python elasticsearch pagination implementation</span></p><p class="c21"><span class="c19"><a class="c13" href="https://www.google.com/url?q=https://stackoverflow.com/questions/8647688/elasticsearch-pagination-through-pyes-offset-ignored&amp;sa=D&amp;ust=1532142477368000">https://stackoverflow.com/questions/8647688/elasticsearch-pagination-through-pyes-offset-ignored</a></span></p><p class="c3 c10"><span class="c5"></span></p><p class="c3 c10"><span class="c5"></span></p><p class="c3"><span class="c27 c12">Highlighting match words:</span></p><p class="c3"><span class="c5">Simply add the &ldquo;highlight&rdquo; part in the query. </span></p><p class="c3"><span class="c5">&nbsp;</span></p><p class="c3"><span class="c4 c12">query = {</span></p><p class="c3"><span class="c4">&nbsp; &nbsp;</span><span class="c8">&quot;query&quot;</span><span class="c4 c12">: {</span></p><p class="c3"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8">&quot;match&quot;</span><span class="c4 c12">: {</span></p><p class="c3"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8">&quot;_all&quot;</span><span class="c4 c12">: search_phrase</span></p><p class="c3"><span class="c4 c12">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c3"><span class="c4 c12">&nbsp; &nbsp;},</span></p><p class="c3"><span class="c4">&nbsp; &nbsp;</span><span class="c8">&quot;highlight&quot;</span><span class="c4 c12">: {</span></p><p class="c3"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8">&quot;fields&quot;</span><span class="c4 c12">: {</span></p><p class="c3"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8">&quot;_all&quot;</span><span class="c4 c12">: {}</span></p><p class="c3"><span class="c4 c12">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c3"><span class="c4 c12">&nbsp; &nbsp;}</span></p><p class="c3"><span class="c4 c12">}</span></p><p class="c3 c10"><span class="c5"></span></p><p class="c3"><span class="c26 c41">By doing this, the result JSON will include the &lsquo;highlight&rsquo; part that has match words with </span><span class="c12 c26 c49">&lt;em&gt; html tag</span></p><p class="c21"><span class="c16 c12">&#39;highlight&#39;: {&#39;_all&#39;: [&#39;0 AIko &lt;em&gt;shiba&lt;/em&gt; male &#39;</span></p><p class="c21"><span class="c16 c12">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;&lt;em&gt;dog&lt;/em&gt; adult large Diesel &#39;</span></p><p class="c21"><span class="c16 c12">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;has made it to All Mutts Matter &#39;</span></p><p class="c21"><span class="c16 c12">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;and he is slowly settling&#39;,</span></p><p class="c21"><span class="c16 c12">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39; into living life as a inside &#39;</span></p><p class="c21"><span class="c16 c12">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;house &lt;em&gt;dog&lt;/em&gt;, eating good &#39;</span></p><p class="c21"><span class="c16 c12">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;food, learning house manners and &#39;</span></p><p class="c21"><span class="c16 c12">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;building his&#39;,</span></p><p class="c21"><span class="c16 c12">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;&amp;width=500&amp;-x.jpg &lt;em&gt;Dallas&lt;/em&gt; &#39;</span></p><p class="c21"><span class="c12 c16">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;TX affectionate | alert | cheerful &#39;</span></p><p class="c21"><span class="c16 c12">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;| courageous | gentle | &#39;</span></p><p class="c21"><span class="c16 c12">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;intelligent&#39;,</span></p><p class="c21"><span class="c16 c12">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39; smell and superior tracking &#39;</span></p><p class="c21"><span class="c16 c12">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;instinct, the beagle is employed &#39;</span></p><p class="c21"><span class="c16 c12">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;as detection &lt;em&gt;dog&lt;/em&gt; for &#39;</span></p><p class="c21"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;prohibited&#39;]}},</span></p><p class="c3 c10"><span class="c5"></span></p><p class="c3"><span class="c5">** reference</span></p><p class="c3"><span class="c14 c26"><a class="c13" href="https://www.google.com/url?q=https://www.elastic.co/guide/en/elasticsearch/reference/2.4/search-request-highlighting.html&amp;sa=D&amp;ust=1532142477370000">https://www.elastic.co/guide/en/elasticsearch/reference/2.4/search-request-highlighting.html</a></span></p><p class="c3"><span class="c27 c12">Data migration from SQL (Phase 2) </span></p><p class="c3"><span class="c5">two ways to do this</span></p><p class="c3"><span class="c5">1: export csv from mysql and import that into Elasticsearch </span></p><p class="c3"><span class="c5">2: Get data from mysql by Shelter.query.all() &nbsp; (*shelter is one of my data model). Then, simply construct doc and call client.create function to insert into Elasticsearch.</span></p><p class="c3"><span class="c41 c26">* I used 2nd method because I had to change some of the fields</span></p><p class="c3"><span class="c1">shelters = Shelter.query.all()</span></p><p class="c3"><span class="c33">for</span><span class="c7">&nbsp;i </span><span class="c28">in</span><span class="c1">&nbsp;shelters:</span></p><p class="c0"><span class="c12 c43 c44">shelter_data_migration(i)</span></p><p class="c0 c10"><span class="c44 c12 c43"></span></p><p class="c3"><span class="c28">def</span><span class="c7">&nbsp;</span><span class="c44 c43">shelter_data_migration</span><span class="c7">(</span><span class="c32">shelter</span><span class="c1">):</span></p><p class="c3"><span class="c1">&nbsp; &nbsp;state = shelter.state</span></p><p class="c3"><span class="c7">&nbsp; &nbsp;</span><span class="c33">if</span><span class="c7">&nbsp;shelter.state </span><span class="c28">in</span><span class="c1">&nbsp;states:</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp;state = shelter.state + </span><span class="c9">&#39; &#39;</span><span class="c1">&nbsp;+ states[shelter.state]</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; </span></p><p class="c3"><span class="c1">&nbsp; &nbsp;doc = {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;id&#39;</span><span class="c1">: shelter.id,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;type&#39;</span><span class="c7">: </span><span class="c9">&#39;animal shelter&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;name&#39;</span><span class="c1">: shelter.name,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;address1&#39;</span><span class="c1">: shelter.address1,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;address2&#39;</span><span class="c1">: shelter.address2,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;city&#39;</span><span class="c1">: shelter.city,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;state&#39;</span><span class="c1">: state,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;zip&#39;</span><span class="c1">: shelter.zip,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;phone&#39;</span><span class="c1">: shelter.phone,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;img_url&#39;</span><span class="c1">: shelter.img_url</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c3"><span class="c1">&nbsp; </span></p><p class="c3"><span class="c7">&nbsp; &nbsp;</span><span class="c12 c42">#return doc</span></p><p class="c3"><span class="c7">&nbsp; &nbsp;client.create(</span><span class="c32">index</span><span class="c7">=</span><span class="c9">&#39;connectpetstome_shelter&#39;</span><span class="c7">, </span><span class="c32">doc_type</span><span class="c7">=</span><span class="c9">&#39;shelter&#39;</span><span class="c7">, </span><span class="c32">body</span><span class="c7">=doc, </span><span class="c32">id</span><span class="c7">=shelter.id)</span></p><p class="c3 c10"><span class="c27 c12"></span></p><p class="c3"><span class="c27 c12">Advance:</span></p><p class="c3"><span class="c5">Create your own analyzer: </span></p><p class="c3"><span class="c9">&quot;filter&quot;</span><span class="c1">: [</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; </span><span class="c9">&quot;lowercase&quot;</span><span class="c1">, &nbsp;// ex: DOG -&gt; dog</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; </span><span class="c9">&quot;asciifolding&quot;</span><span class="c7">, &nbsp; // </span><span class="c38">converts alphabetic, numeric, and symbolic Unicode characters which are not in the first 127 ASCII characters (the &quot;Basic Latin&quot; Unicode block) into their ASCII equivalents, if one exists</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; </span><span class="c9">&quot;stop&quot;</span><span class="c1">, &nbsp; // get rid of stop words (the, is, a, am, are etc)</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; </span><span class="c9">&quot;snowball&quot; &nbsp;</span><span class="c7">// stemmer</span></p><p class="c3"><span class="c8">snowball stem</span><span class="c16 c12">&nbsp;detail</span></p><p class="c21"><span class="c19"><a class="c13" href="https://www.google.com/url?q=http://snowball.tartarus.org/algorithms/porter/stemmer.html&amp;sa=D&amp;ust=1532142477373000">http://snowball.tartarus.org/algorithms/porter/stemmer.html</a></span></p><p class="c3 c10"><span class="c5"></span></p><p class="c3"><span class="c5">The following is the analyzer I used for phase 3 full text search. </span></p><p class="c3"><span class="c1">mappings = {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp;</span><span class="c9">&quot;settings&quot;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;index&quot;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;analysis&quot;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;analyzer&quot;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;customHTMLSnowball&quot;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;type&quot;</span><span class="c7">: </span><span class="c9">&quot;custom&quot;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;char_filter&quot;</span><span class="c1">: [</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c6">&quot;html_strip&quot;</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;],</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;tokenizer&quot;</span><span class="c7">: </span><span class="c9">&quot;standard&quot;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;filter&quot;</span><span class="c1">: [</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;lowercase&quot;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;asciifolding&quot;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;stop&quot;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c6">&quot;snowball&quot;</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;] </span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c3"><span class="c1">&nbsp; &nbsp;},</span></p><p class="c3"><span class="c7">&nbsp; &nbsp;</span><span class="c9">&#39;mappings&#39;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;pet&#39;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;_all&quot;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;enabled&quot;</span><span class="c7">: </span><span class="c28">True</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;store&quot;</span><span class="c7">: </span><span class="c11">True</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;properties&#39;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;id&#39;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;type&#39;</span><span class="c7">: </span><span class="c9">&#39;string&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;index&#39;</span><span class="c7">: </span><span class="c6">&#39;not_analyzed&#39;</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;type&#39;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;type&#39;</span><span class="c7">: </span><span class="c9">&#39;string&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;analyzer&#39;</span><span class="c7">: </span><span class="c9">&#39;customHTMLSnowball&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;store&quot;</span><span class="c7">: </span><span class="c11">True</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;name&#39;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;type&#39;</span><span class="c7">: </span><span class="c9">&#39;string&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;analyzer&#39;</span><span class="c7">: </span><span class="c9">&#39;customHTMLSnowball&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;store&quot;</span><span class="c7">: </span><span class="c11">True</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;breed&#39;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;type&#39;</span><span class="c7">: </span><span class="c9">&#39;string&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;analyzer&#39;</span><span class="c7">: </span><span class="c9">&#39;customHTMLSnowball&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;store&quot;</span><span class="c7">: </span><span class="c11">True</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;sex&#39;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;type&#39;</span><span class="c7">: </span><span class="c9">&#39;string&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;analyzer&#39;</span><span class="c7">: </span><span class="c9">&#39;customHTMLSnowball&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;store&quot;</span><span class="c7">: </span><span class="c11">True</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;animal&#39;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;type&#39;</span><span class="c7">: </span><span class="c9">&#39;string&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;analyzer&#39;</span><span class="c7">: </span><span class="c9">&#39;customHTMLSnowball&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;store&quot;</span><span class="c7">: </span><span class="c11">True</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;age&#39;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;type&#39;</span><span class="c7">: </span><span class="c9">&#39;string&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;analyzer&#39;</span><span class="c7">: </span><span class="c9">&#39;customHTMLSnowball&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;store&quot;</span><span class="c7">: </span><span class="c11">True</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;size&#39;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;type&#39;</span><span class="c7">: </span><span class="c9">&#39;string&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;analyzer&#39;</span><span class="c7">: </span><span class="c9">&#39;customHTMLSnowball&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;store&quot;</span><span class="c7">: </span><span class="c11">True</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;description&#39;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;type&#39;</span><span class="c7">: </span><span class="c9">&#39;string&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;analyzer&#39;</span><span class="c7">: </span><span class="c9">&#39;customHTMLSnowball&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;store&quot;</span><span class="c7">: </span><span class="c11">True</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;city&#39;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;type&#39;</span><span class="c7">: </span><span class="c9">&#39;string&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;analyzer&#39;</span><span class="c7">: </span><span class="c9">&#39;customHTMLSnowball&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;store&quot;</span><span class="c7">: </span><span class="c11">True</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;state&#39;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;type&#39;</span><span class="c7">: </span><span class="c9">&#39;string&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;analyzer&#39;</span><span class="c7">: </span><span class="c9">&#39;customHTMLSnowball&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;store&quot;</span><span class="c7">: </span><span class="c11">True</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;temperament&#39;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;type&#39;</span><span class="c7">: </span><span class="c9">&#39;string&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;analyzer&#39;</span><span class="c7">: </span><span class="c9">&#39;customHTMLSnowball&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;store&quot;</span><span class="c7">: </span><span class="c11">True</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;detail&#39;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;type&#39;</span><span class="c7">: </span><span class="c9">&#39;string&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;analyzer&#39;</span><span class="c7">: </span><span class="c9">&#39;customHTMLSnowball&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;store&quot;</span><span class="c7">: </span><span class="c11">True</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;image_url&#39;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;type&#39;</span><span class="c7">: </span><span class="c9">&#39;string&#39;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&#39;index&#39;</span><span class="c7">: </span><span class="c6">&#39;not_analyzed&#39;</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c3"><span class="c1">&nbsp; &nbsp;}</span></p><p class="c3"><span class="c1">}</span></p><p class="c3 c10"><span class="c12 c27"></span></p><p class="c3 c10"><span class="c27 c12"></span></p><p class="c3"><span class="c6">&quot;&quot;&quot;</span></p><p class="c3"><span class="c6">fuzzy search</span></p><p class="c3"><span class="c6">catch miss spelling</span></p><p class="c3"><span class="c6">Use edit distance 1</span></p><p class="c3"><span class="c6">&quot;&quot;&quot;</span></p><p class="c3"><span class="c1">query = {</span></p><p class="c3"><span class="c7">&nbsp;</span><span class="c9">&quot;query&quot;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp;</span><span class="c9">&quot;fuzzy&quot;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;_all&quot;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;value&quot;</span><span class="c7">: </span><span class="c9">&quot;austins&quot;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;fuzziness&quot;</span><span class="c7">: </span><span class="c12 c30">1</span></p><p class="c3"><span class="c1">&nbsp; &nbsp; &nbsp;}</span></p><p class="c3"><span class="c1">&nbsp; &nbsp;}</span></p><p class="c3"><span class="c1">&nbsp;}</span></p><p class="c3"><span class="c1">}</span></p><p class="c3 c10"><span class="c27 c12"></span></p><p class="c3"><span class="c6">&quot;&quot;&quot;</span></p><p class="c3"><span class="c6">multi_field search</span></p><p class="c3 c10"><span class="c6"></span></p><p class="c3"><span class="c6">specify which fields to search</span></p><p class="c3"><span class="c6">we can boost specific field by adding &quot;^2&quot;</span></p><p class="c3"><span class="c6">&quot;&quot;&quot;</span></p><p class="c3"><span class="c1">query = {</span></p><p class="c3"><span class="c7">&nbsp;</span><span class="c9">&quot;query&quot;</span><span class="c1">:{</span></p><p class="c3"><span class="c7">&nbsp; &nbsp;</span><span class="c9">&quot;multi_match&quot;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;query&quot;</span><span class="c7">: &nbsp;</span><span class="c9">&quot;Thanks yoshi&quot;</span><span class="c1">,</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;fields&quot;</span><span class="c7">: [ </span><span class="c9">&quot;description&quot;</span><span class="c7">, </span><span class="c9">&quot;name^2&quot;</span><span class="c1">]</span></p><p class="c3"><span class="c1">&nbsp; &nbsp;}</span></p><p class="c3"><span class="c1">&nbsp;},</span></p><p class="c3"><span class="c7">&nbsp;</span><span class="c9">&quot;highlight&quot;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp;</span><span class="c9">&quot;fields&quot;</span><span class="c1">: {</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;description&quot;</span><span class="c1">: {},</span></p><p class="c3"><span class="c7">&nbsp; &nbsp; &nbsp;</span><span class="c9">&quot;name&quot;</span><span class="c1">: {}</span></p><p class="c3"><span class="c1">&nbsp; &nbsp;}</span></p><p class="c3"><span class="c1">&nbsp;}</span></p><p class="c3"><span class="c1">}</span></p><p class="c3 c10"><span class="c27 c12"></span></p><p class="c3 c10"><span class="c2"></span></p><p class="c3"><span class="c17 c12">use cases: details about why to use it</span></p><p class="c3"><span class="c2">At the beginning of this tutorial, I posted a link to one video where it explains why Elasticsearch is better than SQL considering full text search. I will paste the link here again.</span></p><p class="c3"><span class="c14"><a class="c13" href="https://www.google.com/url?q=https://www.youtube.com/watch?v%3DUPkqFvjN-yI&amp;sa=D&amp;ust=1532142477386000">https://www.youtube.com/watch?v=UPkqFvjN-yI</a></span></p><p class="c3 c10"><span class="c2"></span></p><p class="c3"><span class="c2">In short,</span></p><p class="c3"><span class="c2">SQL: You can use &quot;Like&quot; clause to search a specific words in columns, but cannot handle something like recognizing &quot;running&quot; and &quot;run&quot; as a similar word. Also, SQL does not consider Term frequency and Inverse Document Frequency like Elasticsearch. So if you search &quot;small dog&quot;, there is no for SQL to know which entries are better match for the search phrase since it does not have matching score. </span></p><p class="c3 c10"><span class="c17 c12"></span></p><p class="c3 c10"><span class="c17 c12"></span></p><p class="c3"><span class="c17 c12">alternatives: what other tools are equivalent, why did you choose this tool</span></p><p class="c3"><span class="c2">As mentioned above, SQL &quot;like&quot; clause is an alternatives, but search results are not as accurate as Elasticsearch, especially ordering.</span></p><p class="c3 c10"><span class="c17 c12"></span></p><p class="c21 c10"><span class="c16 c12"></span></p></body></html>
